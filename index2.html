<!DOCTYPE html>
<html lang="ja" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>暗算ゲーム</title>
    <link rel="stylesheet" href="style.css">
    <meta name="viewport" content="width=device-width, initial-scale=0.85, user-scalable=no" />
  </head>
  <body>
    <h1>暗算げーむ</h1>
    <h3>* むずかしい *</h3>
    <p>ただ暗算するだけのゲーム(？)です。</p>
    <div id="mtext"></div>
    <div id="text"></div>
    <input id="sbhh" type="button" value="判定"></input>
    <input id="sbcc" type="button" value="クリア"></input>
    <input id="sbch" type="button" value="一文字消す"></input>
    <div id="rr"></div>
    <br><br>
    <div id="hantei"></div>
    <a href="index.html">
      <div id="mo">もどる</div>
    </a>
    <script type="text/javascript">
    let num = 0;//textに入力される答え
    let mpu = 0;
    let lnum = 0;//正答

    const sbhh = document.getElementById('sbhh');
    const sbcc = document.getElementById('sbcc');
    const sbch = document.getElementById('sbch');
    const rr = document.getElementById('rr');

    const num1 = Math.floor(Math.random()*50+1)+50;
    //num1をランダムで生成　1-100
    const num2 = Math.floor(Math.random()*20+1);
    //num2をランダムで生成　1-100
    const pu = Math.floor(Math.random()*3+1);
    //puをランダムで生成　1-2
    const mtext = document.getElementById('mtext');
    //表示式

      for(let i = 0;i <= 9;i++){
        const div = document.createElement('div');
        div.classList.add('btn');
       {if(i==0){
          div.textContent = '0';
        }else if (i==1) {
          div.textContent = '1';
        }else if (i==2) {
          div.textContent = '2';
        }else if (i==3) {
          div.textContent = '3';
        }else if (i==4) {
          div.textContent = '4';
        }else if (i==5) {
          div.textContent = '5';
        }else if (i==6) {
          div.textContent = '6';
        }else if (i==7) {
          div.textContent = '7';
        }else if (i==8) {
          div.textContent = '8';
        }else if (i==9) {
          div.textContent = '9';
        }
      }
        div.addEventListener('click',function(){
          text.style.color = "black";
          if (div.textContent == '0') {
            if (num!=0) {
              num = num*10+0;
            }else {
              num = `0`;
            }
            text.textContent = num;
          }else if (div.textContent == '1') {
            if (num!=0) {
              num = num*10+1;
            }else {
              num = 1;
            }
            text.textContent = num;
          }else if (div.textContent == '2') {
            if (num!=0) {
              num = num*10+2;
            }else {
              num = 2;
            }
            text.textContent = num;
          }else if (div.textContent == '3') {
            if (num!=0) {
              num = num*10+3;
            }else {
              num = 3;
            }
            text.textContent = num;
          }else if (div.textContent == '4') {
            if (num!=0) {
              num = num*10+4;
            }else {
              num = 4;
            }
            text.textContent = num;
          }else if (div.textContent == '5') {
            if (num!=0) {
              num = num*10+5;
            }else {
              num = 5;
            }
            text.textContent = num;
          }else if (div.textContent == '6') {
            if (num!=0) {
              num = num*10+6;
            }else {
              num = 6;
            }
            text.textContent = num;
          }else if (div.textContent == '7') {
            if (num!=0) {
              num = num*10+7;
            }else {
              num = 7;
            }
            text.textContent = num;
          }else if (div.textContent == '8') {
            if (num!=0) {
              num = num*10+8;
            }else {
              num = 8;
            }
            text.textContent = num;
          }else if (div.textContent == '9') {
            if (num!=0) {
              num = num*10+9;
            }else {
              num = 9;
            }
            text.textContent = num;
          }
        })
        document.body.appendChild(div);
    }

    if (pu == 1) {
      // mpu = '+';
      mtext.textContent = `${num1}+${num2}=☐`;
      lnum = num1+num2;
    }else if (pu == 2) {
      // mpu = '×';
      lnum = num1*num2;
      mtext.textContent = `${num1}×${num2}=☐`;
    }else if (pu == 3) {
      lnum = num1-num2;
      mtext.textContent = `${num1}-${num2}=☐`;
    }

    var count = 0;
    var countup = function(){
      console.log(count++);
      var id = setTimeout(countup, 1000);
      if(count > 4){　
        clearTimeout(id);
        location.reload()
      }
    }

    sbhh.addEventListener('click',function(){
      if (num == lnum) {
        hantei.textContent = '正解！';
        text.style.color = "blue";
        countup();
      }else if (num == 0 || num == '--') {
          hantei.textContent = '未回答';
          text.textContent = '--';
          text.style.color = "yellow";
        }else{
          hantei.textContent = '不正解！';
          text.style.color = "red";
          text.textContent = `A:${lnum}   ×:${num}`;
          countup();
          // location.reload()
      }
    })

    sbcc.addEventListener('click',function(){
      num = 0;
      text.textContent = '';
    })

    sbch.addEventListener('click',function(){
      num = Math.floor(num/10);
      text.textContent = num;
      if (num == 0) {
        text.textContent = '';
      }
    })

    rr.addEventListener('click',function(){
      location.reload();
    })

    </script>

    <script src="https://unpkg.com/scrollreveal/dist/scrollreveal.min.js">
    </script>
    <script type="text/javascript">
    window.sr = ScrollReveal({ reset: true ,mobile: true});
    sr.reveal( 'p,h1,h3,#sbhh,#sbcc,#sbch', { scale: 1.0,
      delay :200 ,opacity: 0,duration: 1500});

      window.sr = ScrollReveal({ reset: true ,mobile: true});
      sr.reveal('#text',{ origin: 'bottom' , distance: '300%',
      duration: 1000 });

    </script>

  </body>
</html>
